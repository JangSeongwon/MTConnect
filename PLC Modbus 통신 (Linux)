from pymodbus.client import ModbusSerialClient

# Modbus RTU ì„¤ì •
client = ModbusSerialClient(
    method='rtu',          # Modbus RTU ëª¨ë“œ
    port='/dev/ttyUSB0',   # ì§ë ¬ í¬íŠ¸ (í™•ì¸ í•„ìš”)
    baudrate=9600,         # ë³´ë“œë ˆì´íŠ¸ (PLCì™€ ì¼ì¹˜í•´ì•¼ í•¨)
    parity='N',            # íŒ¨ë¦¬í‹° (N=ì—†ìŒ, E=ì§ìˆ˜, O=í™€ìˆ˜)
    stopbits=1,
    bytesize=8,
    timeout=1
)

# ì—°ê²° í™•ì¸
if client.connect():
    print("PLC ì—°ê²° ì„±ê³µ!")

    # ë ˆì§€ìŠ¤í„° 0ë²ˆ ì£¼ì†Œë¶€í„° 10ê°œì˜ ê°’ì„ ì½ìŒ
    result = client.read_holding_registers(0, 10, unit=1)  # unit=1: Modbus ì¥ì¹˜ ID
    if result.isError():
        print("ë°ì´í„° ì½ê¸° ì‹¤íŒ¨")
    else:
        print(f"ë ˆì§€ìŠ¤í„° ê°’: {result.registers}")

    client.close()
else:
    print("PLC ì—°ê²° ì‹¤íŒ¨")



ğŸ“Œ port='/dev/ttyUSB0': ë¦¬ëˆ…ìŠ¤ì˜ ì§ë ¬í¬íŠ¸ ì‚¬ìš© (USB to RS-485 ë³€í™˜ê¸° ì‚¬ìš© ì‹œ /dev/ttyUSB0)
ğŸ“Œ baudrate=9600: PLCì˜ í†µì‹  ì†ë„ì™€ ì¼ì¹˜í•´ì•¼ í•¨
ğŸ“Œ unit=1: Modbus ì¥ì¹˜ ID


