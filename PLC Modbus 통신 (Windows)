from pymodbus.client.sync import ModbusSerialClient

# Modbus RTU ì„¤ì •
client = ModbusSerialClient(
    method='rtu',               # RTU ëª¨ë“œ ì„¤ì •
    port='COM3',                # Windowsì˜ COM í¬íŠ¸ (ì•Œë§ì€ í¬íŠ¸ë¡œ ë³€ê²½)
    baudrate=9600,              # ë³´ë“œë ˆì´íŠ¸ ì„¤ì •
    parity='N',                 # íŒ¨ë¦¬í‹° ì„¤ì • ('N', 'E', 'O' ì¤‘ ì„ íƒ)
    stopbits=1,                 # ìŠ¤í†± ë¹„íŠ¸
    bytesize=8,                 # ë°ì´í„° ë¹„íŠ¸
    timeout=1                   # íƒ€ì„ì•„ì›ƒ ì„¤ì •
)

# í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ì‹œë„
if client.connect():
    print("Modbus RTU ì—°ê²° ì„±ê³µ!")

    # ì˜ˆì œ: ìŠ¬ë ˆì´ë¸Œ ì¥ì¹˜ì˜ ë ˆì§€ìŠ¤í„° ì½ê¸° (ì£¼ì†Œ: 1, ë ˆì§€ìŠ¤í„° ì‹œì‘ ì£¼ì†Œ: 0, ê°œìˆ˜: 1)
    response = client.read_holding_registers(address=0, count=1, unit=1)

    if response.isError():
        print(f"ì½ê¸° ì‹¤íŒ¨: {response}")
    else:
        print(f"ì½ì€ ë°ì´í„°: {response.registers}")

    # ì—°ê²° ì¢…ë£Œ
    client.close()
else:
    print("Modbus RTU ì—°ê²° ì‹¤íŒ¨!")


ğŸ“Œ port='COM3': ì‚¬ìš©í•˜ëŠ” í¬íŠ¸ë¥¼ ì„¤ì •í•´ì•¼ í•´. (ì¥ì¹˜ ê´€ë¦¬ìì—ì„œ í™•ì¸ ê°€ëŠ¥)
ğŸ“Œ baudrate=9600: ì¥ì¹˜ì™€ ì¼ì¹˜í•˜ëŠ” ë³´ë“œë ˆì´íŠ¸ ì„¤ì •.
ğŸ“Œ parity, stopbits, bytesize: ìŠ¬ë ˆì´ë¸Œ ì¥ì¹˜ì™€ ë™ì¼í•˜ê²Œ ì„¤ì •í•´ì•¼ ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ì „ì†¡ë¼.
ğŸ“Œ read_holding_registers: Modbus ìŠ¬ë ˆì´ë¸Œì˜ í™€ë”© ë ˆì§€ìŠ¤í„° ì½ê¸°.
